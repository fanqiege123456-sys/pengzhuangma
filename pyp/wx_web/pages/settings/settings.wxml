<!--pages/settings/settings.wxml-->
<view class="settings-container">
  <!-- 头部 -->
  <view class="header">
    <text class="title">个人设置</text>
    <text class="subtitle">管理你的地址信息和隐私设置</text>
  </view>

  <!-- 地址信息 -->
  <view class="section">
    <view class="section-title">地址信息</view>
    <view class="form-item">
      <view class="label">当前地址</view>
      <picker mode="region" value="{{[locationInfo.province, locationInfo.city, locationInfo.district]}}" bindchange="onRegionChange">
        <view class="picker-display">
          <text class="address-text">
            {{locationInfo.province}} {{locationInfo.city}} {{locationInfo.district}}
          </text>
          <text class="arrow">›</text>
        </view>
      </picker>
    </view>
    <view class="tips">
      <text class="tips-text">• 地址信息用于碰撞匹配时的地理匹配</text>
      <text class="tips-text">• 精确的地址信息可以帮您找到更合适的匹配对象</text>
    </view>
  </view>

  <!-- 隐私设置 -->
  <view class="section">
    <view class="section-title">隐私设置</view>
    
    <view class="form-item">
      <view class="switch-item">
        <view class="switch-info">
          <text class="switch-label">允许上级地区碰撞</text>
          <text class="switch-desc">开启后，其他地区的用户可以通过省份、城市级别碰撞到您</text>
        </view>
        <switch checked="{{allowUpperLevel}}" bindchange="toggleUpperLevel" />
      </view>
    </view>

    <view class="form-item">
      <view class="switch-item">
        <view class="switch-info">
          <text class="switch-label">允许强制添加好友</text>
          <text class="switch-desc">开启后，其他用户可以强制添加您为好友</text>
        </view>
        <switch checked="{{allowForceAdd}}" bindchange="toggleForceAdd" />
      </view>
    </view>

    <view class="form-item">
      <view class="switch-item">
        <view class="switch-info">
          <text class="switch-label">允许被海底捞</text>
          <text class="switch-desc">开启后，其他用户可以通过"海底捞"功能从历史碰撞记录中找到您</text>
        </view>
        <switch checked="{{allowHaidilao}}" bindchange="toggleHaidilao" />
      </view>
    </view>

    <view class="form-item">
      <view class="switch-item">
        <view class="switch-info">
          <text class="switch-label">碰撞结果显示邮箱</text>
          <text class="switch-desc">开启后，您的邮箱会在碰撞结果中显示给匹配用户（需先认证邮箱）</text>
        </view>
        <switch checked="{{emailVisible}}" bindchange="toggleEmailVisible" disabled="{{!emailVerified}}" />
      </view>
      <view class="email-status" wx:if="{{!emailVerified}}">
        <text class="email-tip">请先完成邮箱认证</text>
        <text class="email-link" bindtap="goBindEmail">去认证 ›</text>
      </view>
    </view>
  </view>

  <!-- 说明信息 -->
  <view class="help-section">
    <view class="help-title">碰撞匹配说明</view>
    <view class="help-content">
      <view class="help-item">
        <text class="help-number">1</text>
        <text class="help-text">区县匹配：只有同一区县的用户可以匹配到您</text>
      </view>
      <view class="help-item">
        <text class="help-number">2</text>
        <text class="help-text">城市匹配：同城用户可以匹配，需开启"允许上级地区碰撞"</text>
      </view>
      <view class="help-item">
        <text class="help-number">3</text>
        <text class="help-text">省份匹配：同省用户可以匹配，需开启"允许上级地区碰撞"</text>
      </view>
    </view>
  </view>

  <!-- 保存按钮 -->
  <view class="save-btn" bindtap="saveSettings">保存设置</view>

  <!-- 调试面板按钮 -->
  <view class="debug-btn" bindtap="goToDebug">🔧 调试面板</view>

  <!-- 退出登录按钮 -->
  <view class="logout-btn" bindtap="logout">退出登录</view>
</view>