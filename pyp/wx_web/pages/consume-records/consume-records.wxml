<!--pages/consume-records/consume-records.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="header-decoration">
      <view class="circle circle-1"></view>
      <view class="circle circle-2"></view>
    </view>
    <view class="header-content">
      <text class="title">ğŸ’° æ¶ˆè´¹è®°å½•</text>
      <text class="subtitle">æŸ¥çœ‹ç§¯åˆ†æ¶ˆè´¹æ˜ç»†</text>
    </view>
  </view>

  <!-- Tabåˆ‡æ¢ -->
  <view class="tabs">
    <view class="tab {{currentTab === 'consume' ? 'active' : ''}}" bindtap="switchTab" data-tab="consume">
      æ¶ˆè´¹è®°å½•
    </view>
    <view class="tab {{currentTab === 'recharge' ? 'active' : ''}}" bindtap="switchTab" data-tab="recharge">
      å……å€¼è®°å½•
    </view>
  </view>

  <!-- æ¶ˆè´¹è®°å½•åˆ—è¡¨ -->
  <view class="records-section" wx:if="{{currentTab === 'consume'}}">
    <block wx:if="{{consumeList && consumeList.length}}">
      <scroll-view 
        class="records-scroll" 
        scroll-y 
        bindscrolltolower="loadMoreConsume"
      >
        <view class="records-list">
          <view wx:for="{{consumeList}}" wx:key="id" class="record-item">
            <view class="record-left">
              <view class="record-icon {{item.amount_display > 0 ? 'refund' : 'consume'}}">
                <text>{{item.amount_display > 0 ? '+' : '-'}}</text>
              </view>
              <view class="record-info">
                <text class="record-reason">{{item.reason}}</text>
                <text class="record-time">{{item.created_at_display}}</text>
              </view>
            </view>
            <view class="record-right">
              <text class="record-coins {{item.amount_display > 0 ? 'refund' : 'consume'}}">
                {{item.amount_display > 0 ? '+' : ''}}{{item.amount_display}}
              </text>
              <text class="record-type">{{item.type_display}}</text>
            </view>
          </view>
        </view>
        <view class="load-more">
          <text wx:if="{{consumeLoading}}">åŠ è½½ä¸­...</text>
          <text wx:elif="{{!consumeHasMore}}">æ²¡æœ‰æ›´å¤šäº†</text>
        </view>
      </scroll-view>
    </block>
    <view wx:else class="empty-state">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-title">æš‚æ— æ¶ˆè´¹è®°å½•</text>
      <text class="empty-desc">å‘èµ·ç¢°æ’åä¼šäº§ç”Ÿæ¶ˆè´¹è®°å½•</text>
    </view>
  </view>

  <!-- å……å€¼è®°å½•åˆ—è¡¨ -->
  <view class="records-section" wx:if="{{currentTab === 'recharge'}}">
    <block wx:if="{{rechargeList && rechargeList.length}}">
      <scroll-view 
        class="records-scroll" 
        scroll-y 
        bindscrolltolower="loadMoreRecharge"
      >
        <view class="records-list">
          <view wx:for="{{rechargeList}}" wx:key="id" class="record-item recharge">
            <view class="record-left">
              <view class="record-icon recharge">
                <text>+</text>
              </view>
              <view class="record-info">
                <text class="record-reason">å……å€¼ Â¥{{item.amount_display}}</text>
                <text class="record-time">{{item.created_at_display}}</text>
                <text class="record-order">è®¢å•å·ï¼š{{item.order_no}}</text>
              </view>
            </view>
            <view class="record-right">
              <text class="record-coins recharge">+{{item.coins}}</text>
              <view class="record-status {{item.status}}">{{item.status_display}}</view>
            </view>
          </view>
        </view>
        <view class="load-more">
          <text wx:if="{{rechargeLoading}}">åŠ è½½ä¸­...</text>
          <text wx:elif="{{!rechargeHasMore}}">æ²¡æœ‰æ›´å¤šäº†</text>
        </view>
      </scroll-view>
    </block>
    <view wx:else class="empty-state">
      <text class="empty-icon">ğŸ’³</text>
      <text class="empty-title">æš‚æ— å……å€¼è®°å½•</text>
      <text class="empty-desc">å……å€¼åä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
    </view>
  </view>
</view>
