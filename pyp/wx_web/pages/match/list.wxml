<!--pages/match/list.wxml-->
<view class="match-list-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading && matches.length === 0}}">
    <view class="loading-icon">â³</view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- åŒ¹é…åˆ—è¡¨ -->
  <view class="matches-list" wx:if="{{!loading || matches.length > 0}}">
    <view 
      class="match-item" 
      wx:for="{{matches}}" 
      wx:key="id"
      bindtap="viewDetail"
      data-id="{{item.id}}"
    >
      <!-- ç”¨æˆ·ä¿¡æ¯ -->
      <view class="match-header">
        <image class="avatar" src="{{item.partner.avatar}}" mode="aspectFill" />
        <view class="match-info">
          <view class="partner-info">
            <text class="nickname">{{item.partner.nickname}}</text>
            <view class="status-badge status-{{item.status}}">
              <text wx:if="{{item.status === 'matched'}}">âœ… å·²åŒ¹é…</text>
              <text wx:elif="{{item.status === 'friend_added'}}">ğŸ‰ å·²æ·»åŠ </text>
              <text wx:else>â° å·²é”™è¿‡</text>
            </view>
          </view>
          <view class="match-tag">ğŸ·ï¸ {{item.tag}}</view>
          <view class="match-location">ğŸ“ {{item.matchLocation}}</view>
        </view>
      </view>

      <!-- æ—¶é—´ä¿¡æ¯ -->
      <view class="match-footer">
        <view class="time-info">
          <text class="time-label">åŒ¹é…æ—¶é—´ï¼š</text>
          <text class="time-value">{{item.createdAt}}</text>
        </view>
        <view class="deadline-info" wx:if="{{item.status === 'matched'}}">
          <text class="deadline-label">â±ï¸ </text>
          <text class="deadline-value {{item.isExpired ? 'expired' : ''}}">
            {{item.timeLeft}}
          </text>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="match-actions" catchtap="stopPropagation">
        <!-- æ­£å¸¸æ·»åŠ å¥½å‹ -->
        <button 
          wx:if="{{item.status === 'matched' && !item.isExpired}}"
          class="btn-copy"
          catchtap="copyWechat"
          data-wechat="{{item.partner.wechat_no}}"
        >
          å¤åˆ¶å¾®ä¿¡å·
        </button>
        
        <!-- å¼ºåˆ¶æ·»åŠ å¥½å‹ -->
        <button 
          wx:if="{{item.canForceAdd}}"
          class="btn-force"
          catchtap="forceAddFriend"
          data-id="{{item.id}}"
        >
          å¼ºåˆ¶æ·»åŠ ï¼ˆ100ç§¯åˆ†ï¼‰
        </button>
        
        <!-- å·²æ·»åŠ çŠ¶æ€ -->
        <view wx:if="{{item.status === 'friend_added'}}" class="added-tip">
          âœ… å·²æˆä¸ºå¥½å‹
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && matches.length === 0}}">
    <view class="empty-icon">ğŸ’”</view>
    <view class="empty-text">è¿˜æ²¡æœ‰åŒ¹é…è®°å½•</view>
    <view class="empty-desc">å»ç¢°æ’é¡µé¢å‘èµ·ç¢°æ’å§ï¼</view>
    <button class="btn-primary" bindtap="goToCollision">
      ç«‹å³ç¢°æ’
    </button>
  </view>
</view>
