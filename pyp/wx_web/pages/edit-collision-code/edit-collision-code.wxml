<!--pages/edit-collision-code/edit-collision-code.wxml-->
<view class="container">
  <!-- 头部 -->
  <view class="header">
    <view class="header-decoration">
      <view class="circle circle-1"></view>
      <view class="circle circle-2"></view>
    </view>
    <view class="header-content">
      <text class="header-title">✏️ 修改碰撞码</text>
      <text class="header-subtitle">修改关键词和有效期</text>
    </view>
  </view>

  <!-- 表单 -->
  <form bindsubmit="submitForm" class="form-container">
    <!-- 关键词输入 -->
    <view class="form-section">
      <view class="form-item">
        <text class="form-label">关键词</text>
        <input 
          class="form-input" 
          name="tag" 
          value="{{tag}}" 
          placeholder="请输入关键词"
          bindinput="onTagInput"
          maxlength="20"
        />
        <text class="input-counter">{{tag.length}}/20</text>
      </view>
    </view>

    <!-- 有效期选择 -->
    <view class="form-section">
      <view class="form-item">
        <text class="form-label">有效期</text>
        <picker 
          class="form-picker" 
          mode="selector" 
          range="{{validityOptions}}" 
          range-key="label"
          value="{{selectedValidityIndex}}"
          bindchange="onValidityChange"
        >
          <view class="picker-content">
            <text class="picker-text">{{validityOptions[selectedValidityIndex].label}}</text>
            <text class="picker-arrow">></text>
          </view>
        </picker>
      </view>
    </view>

    <!-- 消耗金币显示 -->
    <view class="form-section">
      <view class="cost-info">
        <view class="cost-item">
          <text class="cost-label">💰 消耗金币</text>
          <text class="cost-value">{{validityOptions[selectedValidityIndex].costCoins}} 金币</text>
        </view>
        <view class="cost-desc">
          <text class="cost-desc-text">修改后将重新开始计时</text>
        </view>
      </view>
    </view>

    <!-- 提交按钮 -->
    <view class="submit-section">
      <button 
        class="submit-btn {{canSubmit ? 'active' : 'disabled'}}" 
        form-type="submit"
        disabled="{{!canSubmit}}"
      >
        {{submitting ? '保存中...' : '保存修改'}}
      </button>
    </view>
  </form>

  <!-- 修改说明 -->
  <view class="tips-section">
    <view class="tips-title">修改说明</view>
    <text class="tips-item">• 修改关键词后仅影响首页展示</text>
    <text class="tips-item">• 延长有效期会立即生效</text>
    <text class="tips-item">• 消耗的金币不可退还</text>
    <text class="tips-item">• 修改后将重新开始匹配</text>
  </view>
</view>
