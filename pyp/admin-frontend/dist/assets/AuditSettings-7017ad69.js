import{_ as M,u as T,r as x,b as D,M as L,c as l,U as N,o as B,d as q,f as a,w as o,V as m,e as s,i as p,h as v,W as U,n as I,t as _,E as d,p as R,v as V,$ as W,a4 as F,s as G}from"./index-1630d45c.js";const H={class:"audit-settings-page"},J={class:"page-header"},K={class:"setting-section"},O={class:"setting-item"},P={class:"setting-left"},Q={class:"setting-icon"},X={class:"card-header"},Y={class:"stat-content"},Z={class:"stat-value"},tt={class:"stat-content"},st={class:"stat-value"},et={class:"stat-content"},at={class:"stat-value"},ot={class:"stat-card total"},nt={class:"stat-content"},lt={class:"stat-value"},dt={class:"quick-actions"},it={__name:"AuditSettings",setup(rt){const y=T(),b=x(!1),w=x(!1),i=x(!1),n=D({pending:0,approved:0,rejected:0,total:0}),j=async()=>{var e;try{const t=await m.get("/dashboard/audit-setting");t.data.code===200&&(i.value=((e=t.data.data)==null?void 0:e.enableCollisionAudit)||!1)}catch(t){console.error("åŠ è½½è®¾ç½®å¤±è´¥:",t)}},C=async()=>{w.value=!0;try{const e=await m.get("/dashboard/audit-stats");e.data.code===200&&e.data.data&&(n.pending=e.data.data.pending||0,n.approved=e.data.data.approved||0,n.rejected=e.data.data.rejected||0,n.total=e.data.data.total||0)}catch(e){console.error("åŠ è½½ç»Ÿè®¡å¤±è´¥:",e)}finally{w.value=!1}},$=async e=>{b.value=!0;try{const t=await m.put("/dashboard/audit-setting",{enableCollisionAudit:e});t.data.code===200?d.success(e?"å·²å¼€å¯ç¢°æ’ç å®¡æ ¸":"å·²å…³é—­ç¢°æ’ç å®¡æ ¸"):(i.value=!e,d.error(t.data.message||"è®¾ç½®å¤±è´¥"))}catch(t){i.value=!e,console.error("è®¾ç½®å¤±è´¥:",t),d.error("è®¾ç½®å¤±è´¥")}finally{b.value=!1}},h=async()=>{if(n.pending!==0)try{await R.confirm(`ç¡®å®šå°†æ‰€æœ‰ ${n.pending} æ¡å¾…å®¡æ ¸ç¢°æ’ç å…¨éƒ¨é€šè¿‡ï¼Ÿ`,"ç¡®è®¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});const e=await m.put("/collisions/batch-approve-all");e.data.code===200?(d.success("å…¨éƒ¨é€šè¿‡æˆåŠŸ"),C()):d.error(e.data.message||"æ“ä½œå¤±è´¥")}catch(e){e!=="cancel"&&(console.error("æ‰¹é‡é€šè¿‡å¤±è´¥:",e),d.error("æ“ä½œå¤±è´¥"))}},g=e=>{e==="pending"?y.push("/audit-list"):y.push({path:"/collision-codes",query:{audit_status:e}})},A=()=>{y.push("/collision-codes")};return L(()=>{j(),C()}),(e,t)=>{const r=l("el-button"),c=l("el-icon"),z=l("el-switch"),k=l("el-card"),f=l("el-col"),S=l("el-row"),E=N("loading");return B(),q("div",H,[a(k,{class:"settings-card"},{default:o(()=>[s("div",J,[t[6]||(t[6]=s("h2",null,"å®¡æ ¸è®¾ç½®",-1)),a(r,{onClick:A},{default:o(()=>[...t[5]||(t[5]=[p("è¿”å›ç¢°æ’ç ç®¡ç†",-1)])]),_:1})]),s("div",K,[s("div",O,[s("div",P,[s("div",Q,[a(c,{size:24},{default:o(()=>[a(v(V))]),_:1})]),t[7]||(t[7]=s("div",{class:"setting-info"},[s("div",{class:"setting-title"},"ç¢°æ’ç å®¡æ ¸"),s("div",{class:"setting-desc"},"å¼€å¯åï¼Œç”¨æˆ·æäº¤çš„ç¢°æ’ç éœ€è¦ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡åæ‰èƒ½å‚ä¸ç¢°æ’åŒ¹é…")],-1))]),a(z,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=u=>i.value=u),loading:b.value,onChange:$,size:"large","active-text":"å¼€","inactive-text":"å…³"},null,8,["modelValue","loading"])])])]),_:1}),a(k,{class:"stats-card"},{header:o(()=>[s("div",X,[t[9]||(t[9]=s("span",null,"å®¡æ ¸ç»Ÿè®¡",-1)),a(r,{type:"primary",text:"",onClick:C},{default:o(()=>[a(c,null,{default:o(()=>[a(v(W))]),_:1}),t[8]||(t[8]=p(" åˆ·æ–° ",-1))]),_:1})])]),default:o(()=>[U((B(),I(S,{gutter:20},{default:o(()=>[a(f,{span:6},{default:o(()=>[s("div",{class:"stat-card pending",onClick:t[1]||(t[1]=u=>g("pending"))},[t[11]||(t[11]=s("div",{class:"stat-icon"},"â³",-1)),s("div",Y,[s("div",Z,_(n.pending),1),t[10]||(t[10]=s("div",{class:"stat-label"},"å¾…å®¡æ ¸",-1))])])]),_:1}),a(f,{span:6},{default:o(()=>[s("div",{class:"stat-card approved",onClick:t[2]||(t[2]=u=>g("approved"))},[t[13]||(t[13]=s("div",{class:"stat-icon"},"âœ…",-1)),s("div",tt,[s("div",st,_(n.approved),1),t[12]||(t[12]=s("div",{class:"stat-label"},"å·²é€šè¿‡",-1))])])]),_:1}),a(f,{span:6},{default:o(()=>[s("div",{class:"stat-card rejected",onClick:t[3]||(t[3]=u=>g("rejected"))},[t[15]||(t[15]=s("div",{class:"stat-icon"},"âŒ",-1)),s("div",et,[s("div",at,_(n.rejected),1),t[14]||(t[14]=s("div",{class:"stat-label"},"å·²æ‹’ç»",-1))])])]),_:1}),a(f,{span:6},{default:o(()=>[s("div",ot,[t[17]||(t[17]=s("div",{class:"stat-icon"},"ğŸ“Š",-1)),s("div",nt,[s("div",lt,_(n.total),1),t[16]||(t[16]=s("div",{class:"stat-label"},"æ€»è®¡",-1))])])]),_:1})]),_:1})),[[E,w.value]])]),_:1}),a(k,{class:"actions-card"},{header:o(()=>[...t[18]||(t[18]=[s("span",null,"å¿«æ·æ“ä½œ",-1)])]),default:o(()=>[s("div",dt,[a(r,{type:"warning",size:"large",onClick:t[4]||(t[4]=u=>g("pending"))},{default:o(()=>[a(c,null,{default:o(()=>[a(v(F))]),_:1}),p(" å¤„ç†å¾…å®¡æ ¸ ("+_(n.pending)+") ",1)]),_:1}),a(r,{type:"success",size:"large",onClick:h,disabled:n.pending===0},{default:o(()=>[a(c,null,{default:o(()=>[a(v(V))]),_:1}),t[19]||(t[19]=p(" å…¨éƒ¨é€šè¿‡ ",-1))]),_:1},8,["disabled"]),a(r,{size:"large",onClick:A},{default:o(()=>[a(c,null,{default:o(()=>[a(v(G))]),_:1}),t[20]||(t[20]=p(" æŸ¥çœ‹å…¨éƒ¨ç¢°æ’ç  ",-1))]),_:1})])]),_:1})])}}},ut=M(it,[["__scopeId","data-v-7cca3eea"]]);export{ut as default};
